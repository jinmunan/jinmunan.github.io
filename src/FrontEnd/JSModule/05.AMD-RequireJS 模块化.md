---
icon: page
order: 5
---
# AMD-RequireJS 模块化

## require.js 使用教程

1. 下载 `require.js`, 并引入

     * 官网：[http://www.requirejs.cn/](http://www.requirejs.cn/)
     * github : [https://github.com/requirejs/requirejs](https://github.com/requirejs/requirejs)
     * 将 require.js 导入项目：js/libs/require.js 
2. 创建项目结构

   ```
   |-js
     |-libs
       |-require.js
     |-modules
       |-alerter.js
       |-dataService.js
     |-main.js
   |-index.html
   ```
3. 定义 `require.js` 的模块代码

     * `dataService.js`
       
       ```javascript
       /*
        定义没有依赖的模块
        */
       define(function () {
         let msg = 'atguigu.com'
       
         function getMsg() {
           return msg.toUpperCase()
         }
       
         return { getMsg }
       })
       ```
     * `alerter.js`
       
       ```javascript
       /*
        定义有依赖的模块
        */
       define(['dataService', 'jquery'], function (dataService, $) {
         let name = 'Tom2'
       
         function showMsg() {
           $('body').css('background', 'gray')
           alert(dataService.getMsg() + ', ' + name)
         }
       
         return { showMsg }
       })
       ```
4. 应用主 (入口) `js`: `main.js`

   ```javascript
   (function () {
     //配置
     require.config({
       //基本路径
       baseUrl: "js/",
       //模块标识名与模块路径映射
       paths: {
         "alerter": "modules/alerter",
         "dataService": "modules/dataService",
       }
     })
     //引入使用模块
     require( ['alerter'], function(alerter) {
       alerter.showMsg()
     })
   })()
   ```
5. 页面使用模块：

   ```javascript
   <script data-main="js/main" src="js/libs/require.js"></script>
   ```
6. 使用第三方基于 `require.js` 的框架 (`jquery`)

     * 将 `jquery` 的库文件导入到项目：
       * `js/libs/jquery-1.10.1.js`
     * 在 `main.js` 中配置 `jquery` 路径
       ```javascript
       paths: {
         //自定义模块
         'alerter': 'modules/alerter',
         'dataService': 'modules/dataService',
       
         //库模块
         'jquery': 'libs/jquery-1.10.1',
       },
       ```
     * 在 `alerter.js` 中使用 `jquery`
       ```javascript
       /*
        定义有依赖的模块
        */
       define(['dataService', 'jquery'], function (dataService, $) {
         let name = 'Tom2'
       
         function showMsg() {
           $('body').css('background', 'gray')
           alert(dataService.getMsg() + ', ' + name)
         }
       
         return { showMsg }
       })
       ```
7. 使用第三方不基于 `require.js` 的框架 (`angular/angular-messages`)
  * 将 `angular.js` 和 `angular-messages.js` 导入项目
    * `js/libs/angular.js`
    * `js/libs/angular-messages.js`
  * 在 `main.js` 中配置
    ```javascript
    (function () {
      //配置
      require.config({
        //基本路径
        baseUrl: 'js/',
        //映射：模块标识名：路径
        paths: {
          //自定义模块
          'alerter': 'modules/alerter',
          'dataService': 'modules/dataService',
    
          //库模块
          'jquery': 'libs/jquery-1.10.1',
          'angular': 'libs/angular'
    
        },
    
        //配置不兼容 AMD 的模块
        shim: {
          angular: {
            exports: 'angular'
          }
    
        }
      })
    
      //引入模块使用
      require(['alerter', 'angular'], function (alerter, angular) {
        alerter.showMsg()
        console.log(angular);
      })
    })()
    ```
  * 页面：
    ```html
    <!DOCTYPE html>
    <html>
    <head>
        <title>Modular Demo 2</title>
    </head>
    <body>
        <script type="text/javascript" src="js/libs/require.js" data-main="js/main.js"></script>
     </body>
    </html>
    ```
