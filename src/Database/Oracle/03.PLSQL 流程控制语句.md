---
icon: page
order: 3
---
# PLSQL 流程控制语句

## 条件语句

```sql
IF <布尔表达式> THEN
	PL/SQL 和 SQL 语句;
END IF;
```

```sql
IF <布尔表达式> THEN
    PL/SQL 和 SQL 语句;
ELSE
    其它语句;
END IF;
```

```sql
IF <布尔表达式> THEN
	PL/SQL 和 SQL 语句;
ELSIF <其它布尔表达式> THEN
	其它语句;
ELSIF <其它布尔表达式> THEN
	其它语句;
ELSE
	其它语句;
END IF;
```

**提示：ELSIF 不能写成 ELSEIF**

```sql
DECLARE
	v_sal emp.sal%type;
BEGIN
	SELECT sal INTO v_sal FROM emp WHERE empno=7369;
    IF v_sal<1200 then
        DBMS_OUTPUT.PUT_LINE('low');
    ELSIF v_sal<2000 then
        DBMS_OUTPUT.PUT_LINE('middle');
    ELSE
        DBMS_OUTPUT.PUT_LINE('high');
   end if;
end;
```

## CASE 表达式

```sql
CASE selector
    WHEN expression1 THEN result1
    WHEN expression2 THEN result2
    
    WHEN expressionN THEN resultN
    [ ELSE resultN+1]
END;
```

```sql
DECLARE
    V_grade char(1) ;
    V_appraisal VARCHAR2(20);
BEGIN
	V_grade := 'B';
    V_appraisal :=
    CASE V_grade
        WHEN 'A' THEN 'Excellent'
        WHEN 'B' THEN 'Very Good'
        WHEN 'C' THEN 'Good'
    ELSE 'No such grade'
    END;
    DBMS_OUTPUT.PUT_LINE('成绩： '||v_grade||'  评价： '|| v_appraisal);
END;
```

## 循环

### 简单循环

```sql
LOOP
    # 要执行的语句;
    EXIT WHEN <条件语句> ; # 条件满足，退出循环语句
END LOOP;
```

```sql
DECLARE
	int NUMBER(2) :=0;
BEGIN
	LOOP
		int := int + 1;
		DBMS_OUTPUT.PUT_LINE('int 的当前值为：'||int);
		EXIT WHEN int =10;
	END LOOP;
END;
```

### WHILE 循环

```sql
WHILE <布尔表达式> LOOP
	要执行的语句;
END LOOP;
```

```sql
DECLARE 
	x NUMBER :=1;
BEGIN
    WHILE x<=10 LOOP
        DBMS_OUTPUT.PUT_LINE('X 的当前值为：'||x);
        x:= x+1;
    END LOOP;
END;
```

### 数字式循环

```sql
FOR 循环计数器 IN [ REVERSE ] 下限 .. 上限 LOOP
	要执行的语句;
END LOOP;
```

每循环一次，循环变量自动加 1；使用关键字 REVERSE，循环变量自动减 1。跟在 IN REVERSE 后面的数字必须是从小到大的顺序，**而且必须是整数，不能是变量或表达式**。可以使用 EXIT 退出循环。

```sql
BEGIN
    FOR int in 1..10 LOOP
    	DBMS_OUTPUT.PUT_LINE('int 的当前值为：'||int);
    END LOOP;
END;
```

```sql
CREATE TABLE temp_table(num_col NUMBER);

DECLARE
	V_counter NUMBER := 10;
BEGIN
	INSERT INTO temp_table(num_col) VALUES (v_counter );
	FOR v_counter IN 20 .. 25 LOOP
		INSERT INTO temp_table (num_col ) VALUES ( v_counter );
	END LOOP;
	
    INSERT INTO temp_table(num_col) VALUES (v_counter );
	FOR v_counter IN REVERSE 20 .. 25 LOOP
		INSERT INTO temp_table (num_col ) VALUES ( v_counter );
	END LOOP;
END ;

SELECT * FROM temp_table;
DROP TABLE temp_table;
```

```sql
NUM_COL
10
20
21
22
23
24
25
10
25
24
23
22
21
20
```

## 标号和 GOTO

PL/SQL 中 GOTO 语句是无条件跳转到指定的标号去的意思。语法如下：

```sql
DECLARE
	. . .
BEGIN
	. . .
    GOTO label;
    . . .
	<<label>>
	. . .
END ;
```

```sql
DECLARE
	V_counter NUMBER := 1;
BEGIN
	LOOP 
		DBMS_OUTPUT.PUT_LINE('V_counter 的当前值为：'||V_counter);
		V_counter := v_counter + 1;
		IF v_counter > 10 THEN
			GOTO ENDofLOOP;
		END IF;
	END LOOP;
	<<ENDofLOOP>>
    DBMS_OUTPUT.PUT_LINE('V_counter 的当前值为：'||V_counter);
END ;
```

## NULL 语句

在 PL/SQL 程序中，可以用 null 语句来说明“不用做任何事情”的意思，相当于一个占位符，可以使某些语句变得有意义，提高程序的可读性。如：

```sql
DECLARE
	V_num NUMBER :=NULL;
BEGIN
	IF V_num IS NULL THEN
		GOTO print1;
	END IF;
	<<print1>>
	NULL;
    DBMS_OUTPUT.PUT_LINE('V_num 的当前值为：'||V_num);
END;
```

