---
icon: page
order: 5
---
# 域对象共享数据

## 什么是域对象？

域对象主要用于 web 应用中，负责存储数据，通俗的讲就是这个对象本身存储一定范围内的所有数据，通过他就能获取和存储数据，可以理解为万能的一个属性，只要调用他就可以获得这个范围（域）内的想要的数据，可以修改删除数据，当然也可以给这个域添加数据

## 域对象分类？

根据作用域的不同分类：

- PageContext 存在于 jsp 文件中，自己本身作为域对象可以存储和查询修改数据，但是目前基本不在应用 jsp，不做过多讲解
- HttpServletRequest 请求域对象，只有一次请求，所以相同的请求域可以用来存储数据并传输域对象共有的方法
- session 域对象，在同一个客户访问服务器时，如果发生了响应重定向，则之前的 request 域中存在的数据就会丢失，所以出现 session 域对象，用来记录是否是同一个客户进行访问，进行会话跟踪，并进行数据存储和获取
- ServletContext 域，公共接口类型，作用域整个 web 项目，用来获取和存储 web 中的数据，ServletContext 接口对象是随着 web 项目的加载而创建的，每个 web 项目都有一个 ServletContext，因此在进行不同的 Servlet 对象之间传递数据时可以使用 ServletContext 域对象

## 使用 ServletAPI 向 request 域对象共享数据

```java
@RequestMapping("/testServletAPI")
public String testServletAPI(HttpServletRequest request){
    request.setAttribute("testScope", "hello,servletAPI");
    return "success";
}
```

## 使用 ModelAndView 向 request 域对象共享数据

```java
@RequestMapping("/testModelAndView")
public ModelAndView testModelAndView(){
    /**
     * ModelAndView 有 Model 和 View 的功能
     * Model 主要用于向请求域共享数据
     * View 主要用于设置视图，实现页面跳转
     */
    ModelAndView mav = new ModelAndView();
    // 向请求域共享数据
    mav.addObject("testScope", "hello,ModelAndView");
    // 设置视图，实现页面跳转
    mav.setViewName("success");
    return mav;
}
```

## 使用 Model 向 request 域对象共享数据

```java
@RequestMapping("/testModel")
public String testModel(Model model){
    model.addAttribute("testScope", "hello,Model");
    return "success";
}
```

## 使用 map 向 request 域对象共享数据

```java
@RequestMapping("/testMap")
public String testMap(Map<String, Object> map){
    map.put("testScope", "hello,Map");
    return "success";
}
```

## 使用 ModelMap 向 request 域对象共享数据

```java
@RequestMapping("/testModelMap")
public String testModelMap(ModelMap modelMap){
    modelMap.addAttribute("testScope", "hello,ModelMap");
    return "success";
}
```

## Model、ModelMap、Map 的关系

Model、ModelMap、Map 类型的参数其实本质上都是 BindingAwareModelMap 类型的

控制器执行后都会返回一个统一的 ModelAndView 的对象，所以 SpringMVC 建议的是使用 ModelAndView，同时，对于原生的 ServletAPI 不建议使用

```java
public interface Model{}
public class ModelMap extends LinkedHashMap<String, Object> {}
public class ExtendedModelMap extends ModelMap implements Model {}
public class BindingAwareModelMap extends ExtendedModelMap {}
```

## 向 session 域共享数据

```java
@RequestMapping("/testSession")
public String testSession(HttpSession session){
    session.setAttribute("testSessionScope", "hello,session");
    return "success";
}
```

在 Thymeleaf 中，对于 session 的数据获取应该为：

```html
<p th:text="${session.CJ}"></p>
```

## 向 application 域共享数据

```java
@RequestMapping("/testApplication")
public String testApplication(HttpSession session){
	ServletContext application = session.getServletContext();
    application.setAttribute("testApplicationScope", "hello,application");
    return "success";
}
```

在 Thymeleaf 中，对于 application 的数据获取应该为

```html
<p th:text="${application.CJ}"></p>
```

